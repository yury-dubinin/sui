---
title: Guidelines
description: Guidelines for working with the Sui GraphQL RPC, how to build effective queries, and how to migrate from JSON RPC.
draft: true
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

For an introduction to GraphQL, see [GitHub's Introduction to GraphQL](https://docs.github.com/en/graphql/guides/introduction-to-graphql).

## Discovering the schema
GraphQL offers an introspection-like service that allows you to query for the schema that is loaded by a service instance. The [official documentation](https://graphql.org/learn/introspection/) provides an overview on introspection.

## Querying the service
Use the following approaches to interact with GraphQL for Sui. 

### Interactive online IDE
Use the interactive online IDE to query the GraphQL service. There are two services available, one for [mainnet](https://rpc.mainnet.mystenlabs.com/graphql) and one for [testnet](https://rpc.testnet.mystenlabs.com/graphql).


### cURL like querying

Include the `query` information in the `data` parameter of the cURL call to query the endpoint using REST:
```shell
# basic query
curl -X POST https://graphql-beta.mainnet.sui.io \
     --header "Content-Type: application/json" \
     --data '{
          "query": "query { epoch { referenceGasPrice } }"
     }'
# query with variables
curl -X POST https://graphql-beta.mainnet.sui.io \
     --header "Content-Type: application/json" \
     --data '{
  "query": "query ($epochID: Int!) { epoch(id: $epochID) { referenceGasPrice } }",
  "variables": {
    "epochID": 123
  }
}'
```

### Working with variables

Variables are a powerful way for passing different object IDs, Digests, Sui addresses, and other kinds of data for full flexibility. The following is an example for querying the reference gas price for epoch `100`, by passing the epoch as a variable:

```graphql
query ($epochID: Int!) {
  epoch(id: $epochID) {
    referenceGasPrice
  }
}
variables {
   "epochID": 100
}
```

And the result is:

```json
{
  "data": {
    "epoch": {
      "referenceGasPrice": "780"
    }
  }
}
```

:::info

When working with the online GraphQL IDE, paste the variables' values in the `Variables` pane on the bottom left of the window, without the `variables` keyword.

:::

### Multiple data in one query
The previous JSON RPC format required multiple queries for more complex data retrieval. With GraphQL, you can specify the fields you need and get that information in one single query. For example, the following query retrieves the first 20 transaction blocks (and the sender's address, the gas object used to pay, the gas price, and budget) after a specific one, at epoch `97`. Previously, in JSON RPC, this required multiple steps.

```graphql
# Fetch the first 20 transactions after 231220100 for epoch 97
{
  epoch(id:97) {
    transactionBlockConnection(first: 20, after:"231220100") {
      pageInfo {
        hasNextPage
        endCursor
      }
      edges {
        cursor
        node {
          digest
          sender {
            address
          }
          effects {
            gasEffects {
              gasObject {
                address
              }
            }
          }
          gasInput {
            gasPrice
            gasBudget
          }
        }
      }
    }
  }
}
  
```


## Migrating guides
The following sections highlight the steps necessary for you to take to migrate your codebase to leverage GraphQL queries on Sui.
### From JSON RPC API

The JSON RPC API provided several individual endpoints to get specific data (for example, `get_totalTransactionBlocks`). While this can be achieved similarly with GraphQL, it is more powerful to determine the data you need in one query that involves multiple aspects (for example, transactions, balance, coins), execute that query, and get the results. This guide showcases how to use GraphQL instead of JSON RPC on a few original endpoints.


#### Example 1: Get total transaction blocks
The goal is to get the total number of transaction blocks in the network.

<Tabs groupId="migrating-json-rpc">

<TabItem value="json-rpc1" label="JSON-RPC">

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "sui_getTotalTransactionBlocks",
  "params": []
}
```

</TabItem>
<TabItem value="graphql1" label="GraphQL">

```graphql
{
  checkpoint {
    networkTotalTransactions
  }
}
```

</TabItem>
</Tabs>

#### Example 2: Get a specific transaction block
The goal is to get the transaction block by its digest.

<Tabs groupId="migrating-json-rpc">

<TabItem value="json-rpc2" label="JSON-RPC">

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "sui_getTransactionBlock",
  "params": [
    "Hay2tj3GcDYcE3AMHrej5WDsHGPVAYsegcubixLUvXUF",
    {
      "showInput": true,
      "showRawInput": false,
      "showEffects": true,
      "showEvents": true,
      "showObjectChanges": false,
      "showBalanceChanges": false
    }
  ]
}
```

</TabItem>
<TabItem value="graphql2" label="GraphQL">

```graphql
{
  transactionBlock(digest: "Hay2tj3GcDYcE3AMHrej5WDsHGPVAYsegcubixLUvXUF") {
    gasInput {
      gasSponsor {
        address
      }
      gasPrice
      gasBudget
    }
    effects {
      status
      timestamp
      checkpoint {
        sequenceNumber
      }
      epoch {
        epochId
        referenceGasPrice
      }
    }
  }
}
```
</TabItem>
</Tabs>

#### Example 3: Get coin objects owned by an address
The goal is to return all `Coin<coin_type>` objects an address owns.

<Tabs groupId="migrating-json-rpc">

<TabItem value="json-rpc3" label="JSON-RPC">

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "suix_getCoins",
  "params": [
    "0x5094652429957619e6efa79a404a6714d1126e63f551f4b6c7fb76440f8118c9", //owner
    "0x2::sui::SUI",                                                      //coin type
    "0xe5c651321915b06c81838c2e370109b554a448a78d3a56220f798398dde66eab", //cursor
    3 //limit
  ]
}
```

</TabItem>
<TabItem value="graphql3" label="GraphQL">

```graphql
{
  address(address: "0x5094652429957619e6efa79a404a6714d1126e63f551f4b6c7fb76440f8118c9") {
    coinConnection(
      first: 3, 
      after: "0x5094652429957619e6efa79a404a6714d1126e63f551f4b6c7fb76440f8118c9", 
      type: "0x2::sui::SUI"
    ) {
      nodes {
        asMoveObject {
          asCoin {
            address
          }
        }
      }
    }
  }
}
```

:::info

The cursor is now passed in the `after` (or `before`) fields on the connection, and the limit in the `first` or `last` fields.

:::

</TabItem>
</Tabs>

### Support in TS SDK
TBD

### Support in Rust SDK
TBD

### Writing your own queries
A good start for writing your own queries is either by browsing the [Examples](./examples) page, or going through the [TS SDK implementation](https://github.com/MystenLabs/sui/tree/main/sdk/typescript/src/graphql/queries).
